(function(t){function e(e){for(var n,s,i=e[0],l=e[1],c=e[2],p=0,d=[];p<i.length;p++)s=i[p],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&d.push(o[s][0]),o[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);u&&u(e);while(d.length)d.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],n=!0,i=1;i<a.length;i++){var l=a[i];0!==o[l]&&(n=!1)}n&&(r.splice(e--,1),t=s(s.s=a[0]))}return t}var n={},o={app:0},r=[];function s(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=n,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(a,n,function(e){return t[e]}.bind(null,n));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/resume-vue/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=e,i=i.slice();for(var c=0;c<i.length;c++)e(i[c]);var u=l;r.push([1,"chunk-vendors"]),a()})({0:function(t,e){},"034f":function(t,e,a){"use strict";var n=a("85ec"),o=a.n(n);o.a},"07ca":function(t,e,a){},1:function(t,e,a){t.exports=a("56d7")},2:function(t,e){},3:function(t,e){},"3da1":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("a52c");var n=a("2ed4"),o=(a("537a"),a("ac28")),r=(a("8a58"),a("e41f")),s=(a("c3a6"),a("ad06")),i=(a("5246"),a("6b41")),l=(a("5852"),a("d961")),c=(a("e930"),a("8f80")),u=(a("66b9"),a("b650")),p=(a("e7e5"),a("d399")),d=(a("9cb7"),a("66fd")),h=(a("4467"),a("c36e")),f=(a("342a"),a("1437")),m=(a("5d17"),a("f9bd")),v=(a("5f1a"),a("a3e2")),g=(a("0653"),a("34e9")),b=(a("c194"),a("7744")),y=(a("b000"),a("1a23")),w=(a("e17f"),a("2241")),k=a("a026"),A=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},M=[],S={name:"app"},_=S,x=(a("034f"),a("2877")),L=Object(x["a"])(_,A,M,!1,null,null,null),C=L.exports,O=a("8f9b"),j=a.n(O),$=a("8c4f"),P=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("van-nav-bar",{attrs:{title:"乡镇查询"}},[a("van-icon",{attrs:{slot:"right",name:"search"},on:{click:function(e){return t.handleSearch()}},slot:"right"})],1),a("div",{ref:"imageTofile",staticClass:"amap-page-container"},[a("el-amap-search-box",{directives:[{name:"show",rawName:"v-show",value:t.isSearch,expression:"isSearch"}],staticClass:"search-box",attrs:{"search-option":t.searchOption,"on-search-result":t.onSearchResult}}),a("el-amap",{staticClass:"amap-demo",attrs:{vid:"amapDemo",center:t.center,plugin:t.plugin,"amap-manager":t.amapManager,zoom:t.zoom,events:t.events}},t._l(t.markers,(function(e,n){return a("el-amap-text",{key:n,attrs:{position:e.position,events:e.events,visible:e.visible,draggable:e.draggable,vid:n,text:t.showAll?e.tag:e.country}})})),1)],1),a("van-tabbar",{model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[a("van-tabbar-item",{attrs:{icon:"home-o"},on:{click:function(e){t.isSearch=!1}}},[t._v("首页")]),a("van-tabbar-item",{attrs:{icon:"search"},on:{click:function(e){return t.handleSearch()}}},[t._v("查询")]),a("van-tabbar-item",{attrs:{icon:"upgrade"},on:{click:function(e){t.show=!0}}},[t._v("上传")])],1),a("van-popup",{staticStyle:{height:"75%"},attrs:{position:"bottom",round:"",closeable:""},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("Upload",{on:{handleAdd:t.addMarker,handleAddAll:t.showAllMarker,change:t.handleChange}})],1)],1)},T=[],N=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"upload"},[a("div",{staticClass:"upload-tab"},[a("van-uploader",{ref:"inputName",attrs:{accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",multiple:""},model:{value:t.fileList,callback:function(e){t.fileList=e},expression:"fileList"}}),a("h3",[t._v("上传文件，文件大小<5M")]),a("div",{staticClass:"operation"},[a("van-button",{staticClass:"operation-btn",attrs:{plain:"",type:"info"},on:{click:function(e){return t.handleOk()}}},[t._v("上传文件解析")]),a("van-button",{staticClass:"operation-btn",attrs:{plain:"",type:"info"},on:{click:function(e){return t.handlePrint()}}},[t._v("截图全部数据")]),a("div",{staticClass:"operation-btn"},[t._v(" 简称 "),a("van-switch",{model:{value:t.showAll,callback:function(e){t.showAll=e},expression:"showAll"}}),t._v("全称 ")],1)],1)],1),t.dataList?a("van-collapse",{attrs:{accordion:""},model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},t._l(t.dataList,(function(e,n){return a("van-collapse-item",{key:n,attrs:{title:e.name,name:n}},[a("van-swipe-cell",[a("van-cell",{attrs:{border:!1,title:"共"+e.points.length+"个标记"}},t._l(e.points,(function(e,n){return a("van-tag",{key:n,attrs:{plain:"",type:"primary"}},[t._v(t._s(t.showAll?e.tag:e.country))])})),1),a("template",{slot:"right"},[a("van-button",{staticStyle:{height:"100%"},attrs:{square:"",type:"info",text:"标记"},on:{click:function(e){return t.onMark(n)}}})],1)],2)],1)})),1):t._e()],1)},E=[],R=a("1146"),U=a.n(R),B={data(){return{activeNames:0,parmas:[],fileList:[],showAll:!0,dataList:[{name:"安福县-jc",count:2,points:[{tag:"新乡石陂村",country:"石陂村",position:[120.002,24.0211]},{tag:"新乡石陂村",country:"石陂村",position:[121.402,25.0211]}]}]}},watch:{showAll(t,e){console.log("change"),this.$emit("change",this.showAll)}},methods:{onMark(t){var e=this.dataList[parseInt(t)];console.log(e),this.$emit("handleAdd",e)},handleOk(){this.$toast.loading({message:"解析中...",forbidClick:!0,overlay:!0,duration:5e3});let t=this;new Promise(n=>{let o=U.a,r=!1,s=t.fileList.map(t=>t.file);t.parmas=[];for(var i=0;i<s.length;i++){var l=s[i],c=new FileReader,u=l.name;sessionStorage.setItem("name",u),c.onload=function(t){var n,s=t.target.result;if(r)n=o.read(s,{type:"binary"});else{var i=a(s);n=o.read(btoa(i),{type:"base64"})}e(n,"json")},r?c.readAsBinaryString(l):c.readAsArrayBuffer(l)}n()}).then(()=>{setTimeout(()=>{t.getList()},1e3)}).then(()=>{t.$toast.clear()}).catch(()=>{t.$toast.fail({message:"解析失败"})});function e(t,e){var a="";if("json"===e)return a=JSON.stringify(n(t),2,2),a}function a(t){let e="",a=0,n=10240;for(;a<t.byteLength/n;++a)e+=String.fromCharCode.apply(null,new Uint8Array(t.slice(a*n,a*n+n)));return e+=String.fromCharCode.apply(null,new Uint8Array(t.slice(a*n))),e}function n(e){var a={};e.SheetNames.forEach((function(t){var n=U.a.utils.sheet_to_row_object_array(e.Sheets[t]);n.length>0&&(a[t]=n)}));let n=a.Sheet1;return t.parmas.push(n),console.log(t.parmas),a}},getList(){if(this.parmas!==[]){let o=this.parmas[0];for(var t,e=[],a=0,n=o.length;a<n-1;){t={name:o[a].name,points:[{tag:o[a].tag,country:o[a].country,position:[o[a].lng,o[a].lat]}]};for(let r=a+1;r<n;r++){if(o[a].name!=o[r].name){if(r==n-1){e.push(t,{name:o[r].name,points:[{tag:o[r].tag,country:o[r].country,position:[o[r].lng,o[r].lat]}]}),a=n;break}a=r,e.push(t);break}if(t.points.push({tag:o[r].tag,country:o[r].country,position:[o[r].lng,o[r].lat]}),r==n-1){e.push(t),a=n;break}}}this.dataList=e}else this.dataList=[]},handlePrint(){this.$emit("handleAddAll",this.dataList)}}},I=B,z=(a("d0c3"),Object(x["a"])(I,N,E,!1,null,"19c4754a",null)),J=z.exports,q=a("c0e9"),D=a.n(q);let F=new O["AMapManager"];var G={components:{Upload:J,html2canvas:D.a},data(){let t=this;return{showAll:!0,dataList:[],markers:[],searchOption:{city:"江西",citylimit:!1},lng:0,lat:0,show:!1,isSearch:!1,zoom:15,center:[121.59996,31.197646],amapManager:F,plugin:[{pName:"Geolocation",events:{init(e){console.log(e),e.getCurrentPosition((e,a)=>{"error"==e&&t.$toast.fail("定位失败"),console.log(e,a),a&&a.position&&(t.lng=a.position.lng,t.lat=a.position.lat,t.center=[t.lng,t.lat],t.loaded=!0,console.log(t.center),t.$nextTick())})}}},{pName:"ToolBar",events:{init(t){console.log(t)}}}],events:{init(t){t.setMapStyle("amap://styles/normal")},complete(){const e=t.amapManager.getMap();e.setFitView()}}}},computed:{active(t){return 1==this.isSearch?1:0}},methods:{add(t,e){let a=F.getMap(),n=new AMap.Marker({position:[t,e]});n.setMap(a)},toImage(t){D()(this.$refs.imageTofile,{backgroundColor:null,useCORS:!0}).then(e=>{let a=document.createElement("a");a.href=e.toDataURL(),a.setAttribute("download",`${t}.png`),a.style.display="none",document.body.appendChild(a),a.click()})},async showAllMarker(t){this.dataList=t;for(let e=0;e<this.dataList.length;e++)setTimeout(()=>{this.addMarker(this.dataList[e]),this.toImage(this.dataList[e].name)},2e3*e)},handleSearch(){this.isSearch=!this.isSearch},handleChange(t){this.showAll=t},addMarker(t){var e=t.points.map(t=>({tag:t.tag,country:t.country,position:t.position}));function a(t){let e=t.length,a=t.reduce((t,e)=>t+e.position[0],0),n=t.reduce((t,e)=>t+e.position[1],0);return[a/e,n/e]}console.log(e),this.markers=[],this.markers.push(...e),this.center=a(this.markers),this.show=!1},onSearchResult(t){let e=0,a=0;if(t.length>0){t.forEach(t=>{let{lng:n,lat:o}=t;a+=n,e+=o,this.markers=[],this.markers.push({tag:"你的位置",conuntry:"你的位置",position:[t.lng,t.lat]})});let n={lng:a/t.length,lat:e/t.length};this.center=[n.lng,n.lat],this.$toast.success("定位成功")}}}},V=G,H=(a("5c7a"),Object(x["a"])(V,P,T,!1,null,"cfdd8ba2",null)),K=H.exports;k["default"].use($["a"]);var Q=new $["a"]({mode:"history",routes:[{path:"/",name:"home",component:K},{path:"/upload",name:"upload",component:J}]}),W=(a("f0e6"),a("bc3a")),X=a.n(W),Y=a("4328"),Z=a.n(Y),tt=a("e301"),et=a.n(tt);k["default"].prototype.$axios=X.a,new et.a({key:65}),k["default"].prototype.qs=Z.a,k["default"].use(w["a"]),k["default"].use(y["a"]),k["default"].use(b["a"]),k["default"].use(g["a"]),k["default"].use(v["a"]),k["default"].use(m["a"]),k["default"].use(f["a"]),k["default"].use(h["a"]),k["default"].use(d["a"]),k["default"].use(p["a"]),k["default"].use(u["a"]),k["default"].use(c["a"]),k["default"].use(l["a"]),k["default"].use(i["a"]),k["default"].use(s["a"]),k["default"].use(r["a"]),k["default"].use(o["a"]),k["default"].use(n["a"]),k["default"].config.productionTip=!1,k["default"].use(j.a),j.a.initAMapApiLoader({key:"\t4f9202c0f61ad5b1db4566c4534ab803",plugin:["AMap.Autocomplete","AMap.PlaceSearch","AMap.Scale","AMap.OverView","AMap.ToolBar","AMap.MapType","AMap.PolyEditor","AMap.CircleEditor","AMap.Geolocation"],v:"1.4.4"}),new k["default"]({router:Q,render:t=>t(C)}).$mount("#app")},"5c7a":function(t,e,a){"use strict";var n=a("07ca"),o=a.n(n);o.a},"85ec":function(t,e,a){},d0c3:function(t,e,a){"use strict";var n=a("3da1"),o=a.n(n);o.a}});
//# sourceMappingURL=app.9e76d27e.js.map